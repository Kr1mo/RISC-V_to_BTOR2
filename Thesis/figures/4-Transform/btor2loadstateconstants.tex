\begin{algorithm}
    $true\_pc \leftarrow$ value of pc in state file\\
    $max\_pc \leftarrow$ number of addresses in BTOR2 model\\
    \textcolor{UniBlue}{pc\_value} $\leftarrow true\_pc$ modulo $max\_pc$\\
    add to model:\\
    \begin{tabular}[h]{>{\color{UniRed}}r l >{\color{UniGrey}}l l >{\itshape} l}
        \hline
        \hline
        \ttfamily
        (n + 0) & constd & AS & \textcolor{UniBlue}{\rmfamily\textit{pc\_value}} & pc\_const \\
        \hline
        \hline
    \end{tabular}\\
    \textcolor{UniRed}{n} += 1
    \BlankLine

    \For{every register \textcolor{Green}{$x_i$}}{
        \If{register is initialised in state file}{
            \textcolor{UniBlue}{$register\_value$} $\leftarrow$ value of \textcolor{Green}{$x_i$}\\
            \If{\textcolor{UniBlue}{$register\_value$} $\neq 0$}{
                add to model:\\
                \begin{tabular}[h]{>{\color{UniRed}}r l >{\color{UniGrey}}l l >{\itshape} l}
                    \hline
                    \hline
                    \ttfamily
                    (n + 0) & constd & D & \textcolor{UniBlue}{\rmfamily$register\_value$} & \textcolor{Green}{$x_i$}\_const \\
                    \hline
                    \hline
                \end{tabular}\\
                \textcolor{UniRed}{n} += 1
            }
        }
    }
    \BlankLine
    add to model:\\

    \begin{tabular}[h]{>{\ttfamily\color{UniRed}}r >{\ttfamily}l >{\ttfamily\color{UniGrey}}l >{\ttfamily}l >{\itshape} l}
        \hline
        \hline
        (n + 0) & state & Mem &                                       & mem\_ph \\
        (n + 1) & init  & Mem & \textcolor{UniRed}{$mem\_ph$ (n + 0)} &         \\
        \hline
        \hline
    \end{tabular}\\
    \textcolor{UniRed}{n} += 2\\

    $\textcolor{UniRed}{last\_ph} \leftarrow \textcolor{UniRed}{mem\_ph}$\\
    $all\_initial\_cells \leftarrow$ all initialised memory cells in the state file\\
    $cut\_initial\_cells \leftarrow$ remove all cells with address over max\_pc\\
    \For{every cell \textcolor{Green}{$c$} in $cut\_initial\_cells$}{
        $address \leftarrow$ address of \textcolor{Green}{$c$}\\
        $value \leftarrow$ value of \textcolor{Green}{$c$}\\
        add to model:\\
        \begin{tabular}[h]{>{\ttfamily\color{UniRed}}r >{\ttfamily}l >{\ttfamily\color{UniGrey}}l >{\ttfamily}l >{\itshape} l}
            \hline
            \hline
            \ttfamily
            (n + 0) & constd & AS  & \textcolor{UniBlue}{\rmfamily$address$}                 &                                 \\
            (n + 1) & constd & B   & \textcolor{UniBlue}{\rmfamily$value$}                   &                                 \\
            (n + 2) & write  & Mem & \textcolor{UniRed}{\textrm{$last\_ph$} (n + 0) (n + 1)} & ph\_after\_\textcolor{Green}{c} \\
            \hline
            \hline
        \end{tabular}\\
        \textcolor{UniRed}{n} += 3\\
        $\textcolor{UniRed}{last\_ph} \leftarrow \textcolor{UniRed}{ph\_after\_\textcolor{Green}{c}}$\\
    }
    keep  $\textcolor{UniRed}{last\_ph}$ for initialisation

    \caption[Generating initialisation constants]{Generating initialisation constants from state file in BTOR2}\label{alg:generateconstantsfromstate}
\end{algorithm}