\begin{algorithm}
    add to model:\\
    \begin{tabular}[h]{>{\ttfamily\color{UniRed}}r >{\ttfamily}l >{\ttfamily\color{UniGrey}}l >{\slshape\color{UniRed}}l >{\slshape\color{UniRed}}l >{\slshape\color{UniRed}}l >{\slshape} l}
        \hline
        \hline
        (n + 0)  & eq & Bool & opcode & load    &  & isLoad    \\
        (n + 1)  & eq & Bool & opcode & opImm   &  & isOpImm   \\
        (n + 2)  & eq & Bool & opcode & auipc   &  & isAUIPC   \\
        (n + 3)  & eq & Bool & opcode & opImm32 &  & isOpImm32 \\
        (n + 4)  & eq & Bool & opcode & store   &  & isStore   \\
        (n + 5)  & eq & Bool & opcode & op      &  & isOp      \\
        (n + 6)  & eq & Bool & opcode & lui     &  & isLUI     \\
        (n + 7)  & eq & Bool & opcode & op32    &  & isOp32    \\
        (n + 8)  & eq & Bool & opcode & branch  &  & isBranch  \\
        (n + 9)  & eq & Bool & opcode & jalr    &  & isJALR    \\
        (n + 10) & eq & Bool & opcode & jal     &  & isJAL     \\
        \hline
        \hline
    \end{tabular}\\
    \For{\textcolor{Green}{i} from 0 to 7}{
        add to model:\\
        \begin{tabular}[h]{>{\ttfamily\color{UniRed}}r >{\ttfamily}l >{\ttfamily\color{UniGrey}}l >{\slshape\color{UniRed}}l >{\slshape\color{UniRed}}l >{\slshape\color{UniRed}}l >{\slshape} l}
            \hline
            \hline
            n & eq & Bool & funct3 & \textcolor{Green}{i}Const &  & is\textcolor{Green}{i}Funct3 \\
            \hline
            \hline
        \end{tabular}\\
    }
    $\textcolor{Green}{onlyOp} \leftarrow$ [LUI, AUIPC, JAL, JALR]\\
    $\textcolor{Green}{needsf7} \leftarrow$ [SRL, SRA, SRLI, SRAI, SRLW, SRAW, SRLWI, SRAWI, ADD, SUB, ADDW, SUBW]\\
    $\textcolor{Green}{rest} \leftarrow$[ all other instructions ]\\
    \BlankLine
    \For{ all instructions \textcolor{Green}{I} in \color{Green}$onlyOp$}{
        $is\textcolor{Green}{I}$ is already defined
    }
    \For{all instructions  \textcolor{Green}{I} in \color{Green}$rest$}{
        $\textcolor{Green}{opname} \leftarrow$ opcode name of \textcolor{Green}{I}\\
        $\textcolor{Green}{f3val} \leftarrow$ expected funct3 of \textcolor{Green}{I} as digit\\
        add to model:\\
        \begin{tabular}[h]{>{\ttfamily\color{UniRed}}r >{\ttfamily}l >{\ttfamily\color{UniGrey}}l >{\slshape\color{UniRed}}l >{\slshape\color{UniRed}}l >{\slshape\color{UniRed}}l >{\slshape} l}
            \hline
            \hline
            n & and & Bool & is\textcolor{Green}{opname} & is\textcolor{Green}{f3val}Funct3 &  & is\textcolor{Green}{I} \\
            \hline
            \hline
        \end{tabular}\\
    }
    \For{all instructions  \textcolor{Green}{I} in \color{Green}$needsf7$}{
        $\textcolor{Green}{opname} \leftarrow$ opcode name of \textcolor{Green}{I}\\
        $\textcolor{Green}{f3val} \leftarrow$ expected funct3 of \textcolor{Green}{I} as digit\\
        $\textcolor{Green}{f7hex} \leftarrow$ expected funct7 of \textcolor{Green}{I} as hexadecimal number\\
        add to model:\\
        \begin{tabular}[h]{>{\ttfamily\color{UniRed}}r >{\ttfamily}l >{\ttfamily\color{UniGrey}}l >{\slshape\color{UniRed}}l >{\slshape\color{UniRed}}l >{\slshape\color{UniRed}}l >{\slshape} l}
            \hline
            \hline
            (n + 0) & consth & W    & \textcolor{Green}{f7hex}         &                          &  &                        \\
            (n + 1) & eq     & Bool & funct7                           & \upshape\ttfamily(n + 0) &  &                        \\
            (n + 2) & and    & Bool & is\textcolor{Green}{f3val}Funct3 & \upshape\ttfamily(n + 1) &  &                        \\
            (n + 3) & and    & Bool & is\textcolor{Green}{opname}      & \upshape\ttfamily(n + 2) &  & is\textcolor{Green}{I} \\
            \hline
            \hline
        \end{tabular}\\
    }
    \caption[Instruction Detection Logic]{Generalized Approach to Instruction Detection}\label{alg:commanddetection}
\end{algorithm}